<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Seleção de Metodologia de Rating</title>
  <meta name="description" content="Menu para acessar os simuladores simplificados de Moody's, Fitch e S&P."/>
  <script src="https://cdn.tailwindcss.com"></script>
  <link rel="preconnect" href="https://fonts.googleapis.com"/>
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin/>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;700&display=swap" rel="stylesheet"/>
  <style>
    body{font-family:'Inter',sans-serif;background:#FFFFFF}
    .title-color{color:#1E428B}
    .green-title-color{color:#009933}
    .btn-primary{background:#1E428B;color:#FFFFFF;transition:background-color .3s ease, transform .2s ease}
    .btn-primary:hover{background:#16336a;transform:translateY(-2px)}
    .btn-secondary{background:#FFFFFF;color:#1E428B;border-color:#1E428B;transition:background-color .3s ease, color .3s ease, transform .2s ease}
    .btn-secondary:hover{background:#f0f5ff;transform:translateY(-2px)}
  </style>
</head>
<body class="bg-white flex items-center justify-center min-h-screen p-4">
  <main class="w-full max-w-lg bg-gray-50 p-8 sm:p-12 rounded-2xl shadow-lg border border-gray-200 text-center">
    <header class="mb-10">
      <h1 class="text-4xl font-bold green-title-color">Selecione a metodologia</h1>
      <p class="text-gray-600 mt-3">Escolha uma agência para iniciar a simulação de rating do projeto.</p>
    </header>

    <section class="space-y-5 flex flex-col">
      <!-- S&P -->
      <a href="sp.html"
         class="btn-primary w-full py-4 px-6 text-lg font-bold rounded-xl shadow-md focus:outline-none focus:ring-4 focus:ring-blue-300 block text-center"
         aria-label="Abrir simulador S&P Ratings">
         S&amp;P Ratings
      </a>

      <!-- Moody's -->
      <a href="moody.html"
         class="btn-secondary w-full py-4 px-6 text-lg font-bold rounded-xl shadow-md border-2 focus:outline-none focus:ring-4 focus:ring-blue-300 block text-center"
         aria-label="Abrir simulador Moody's">
         Moody's
      </a>

      <!-- Fitch -->
      <a href="fitch.html"
         class="btn-secondary w-full py-4 px-6 text-lg font-bold rounded-xl shadow-md border-2 focus:outline-none focus:ring-4 focus:ring-blue-300 block text-center"
         aria-label="Abrir simulador Fitch Ratings">
         Fitch
      </a>
    </section>

    <footer class="mt-12">
      <p class="text-xs text-gray-500">Cada simulador é uma interpretação simplificada da metodologia pública de sua respectiva agência.</p>
    </footer>
  </main>

  <!-- Script do Chatbot -->
  <script type="module">
    import Chatbot from "https://cdn.jsdelivr.net/npm/flowise-embed/dist/web.js"
    
    Chatbot.init({
      chatflowid: "61404541-6f1e-4364-8ef8-3647f4573ea6",
      apiHost: "https://cloud.flowiseai.com",
      theme: {
        button: {
          backgroundColor: "#1E428B",
          iconColor: "#FFFFFF",
          size: "56px",
          bottom: "20px",
          right: "20px",
          borderRadius: "50%"
        },
        chatWindow: {
          title: "Chatbot Metodologia de Risco de Crédito",
          titleBackgroundColor: "#009933",
          backgroundColor: "#FFFFFF",
          textColor: "#1E428B",
          poweredByTextColor: "#999999",
          height: "100vh",
          width: "400px"
        }
      },
      initialMessages: [
        "O que posso ajudar referente a metodologia de risco de crédito das agências Fitch, Moody's e S&P Ratings?"
      ]
    }).then(() => {
      // Aguarda o chatbot ser completamente carregado
      setTimeout(() => {
        applyCustomStyles();
        setupChatBehavior();
      }, 3000);
    });

    function applyCustomStyles() {
      // Remove estilos existentes conflitantes
      const existingStyle = document.getElementById('flowise-custom-styles');
      if (existingStyle) existingStyle.remove();

      // Criar e inserir novos estilos
      const style = document.createElement('style');
      style.id = 'flowise-custom-styles';
      style.textContent = `
        /* FORÇA o botão para o canto inferior direito */
        div[style*="position: fixed"][style*="bottom"][style*="right"] {
          position: fixed !important;
          bottom: 20px !important;
          right: 20px !important;
          top: auto !important;
          left: auto !important;
          transform: none !important;
          width: 56px !important;
          height: 56px !important;
          border-radius: 50% !important;
          background-color: #1E428B !important;
          z-index: 10000 !important;
          box-shadow: 0 4px 12px rgba(0,0,0,0.2) !important;
        }

        /* Container do chat - lateral direita */
        div[style*="position: fixed"][style*="width"][style*="height"]:not([style*="56px"]) {
          position: fixed !important;
          top: 0 !important;
          right: 0 !important;
          bottom: 0 !important;
          left: auto !important;
          width: 400px !important;
          max-width: 90vw !important;
          height: 100vh !important;
          max-height: 100vh !important;
          border-radius: 0 !important;
          z-index: 9999 !important;
          transform: none !important;
          box-shadow: -4px 0 15px rgba(0,0,0,0.1) !important;
        }

        /* Estrutura interna do chat */
        div[style*="position: fixed"][style*="width"][style*="height"]:not([style*="56px"]) > div {
          height: 100% !important;
          display: flex !important;
          flex-direction: column !important;
          overflow: hidden !important;
        }

        /* Header do chat */
        div[style*="position: fixed"][style*="width"][style*="height"]:not([style*="56px"]) > div > div:first-child {
          flex-shrink: 0 !important;
          background: #009933 !important;
          color: white !important;
          padding: 16px !important;
          position: relative !important;
        }

        /* Área de mensagens - FORÇAR SCROLL */
        div[style*="position: fixed"][style*="width"][style*="height"]:not([style*="56px"]) > div > div:nth-child(2),
        div[style*="overflow"] {
          flex: 1 !important;
          overflow-y: auto !important;
          overflow-x: hidden !important;
          padding: 16px !important;
          max-height: calc(100vh - 140px) !important;
          min-height: 0 !important;
        }

        /* Input do chat - FORÇAR NA PARTE INFERIOR */
        div[style*="position: fixed"][style*="width"][style*="height"]:not([style*="56px"]) > div > div:last-child,
        div[style*="position: fixed"][style*="width"][style*="height"]:not([style*="56px"]) form,
        div[style*="position: fixed"][style*="width"][style*="height"]:not([style*="56px"]) input[type="text"] {
          position: sticky !important;
          bottom: 0 !important;
          flex-shrink: 0 !important;
          background: white !important;
          padding: 16px !important;
          border-top: 1px solid #e5e7eb !important;
          z-index: 1000 !important;
        }

        /* Responsivo */
        @media (max-width: 768px) {
          div[style*="position: fixed"][style*="width"][style*="height"]:not([style*="56px"]) {
            width: 100vw !important;
            left: 0 !important;
            right: 0 !important;
          }
        }

        /* Força scroll em todos os elementos de mensagem */
        * {
          scrollbar-width: thin;
          scrollbar-color: #cbd5e1 #f1f5f9;
        }
        
        *::-webkit-scrollbar {
          width: 6px;
        }
        
        *::-webkit-scrollbar-track {
          background: #f1f5f9;
        }
        
        *::-webkit-scrollbar-thumb {
          background: #cbd5e1;
          border-radius: 3px;
        }
      `;
      document.head.appendChild(style);

      // Força aplicação dos estilos em intervalos
      const forceStyles = () => {
        const elements = document.querySelectorAll('div[style*="position: fixed"]');
        elements.forEach(el => {
          if (el.style.width === '56px' || el.style.height === '56px') {
            // É o botão
            el.style.cssText += `
              position: fixed !important;
              bottom: 20px !important;
              right: 20px !important;
              top: auto !important;
              left: auto !important;
            `;
          } else {
            // É o container do chat
            el.style.cssText += `
              position: fixed !important;
              top: 0 !important;
              right: 0 !important;
              width: 400px !important;
              height: 100vh !important;
            `;
          }
        });
      };

      // Aplicar estilos múltiplas vezes para garantir
      setTimeout(forceStyles, 100);
      setTimeout(forceStyles, 500);
      setTimeout(forceStyles, 1000);
      setTimeout(forceStyles, 2000);
    }

    function setupChatBehavior() {
      // Observer para detectar mudanças no DOM
      const observer = new MutationObserver((mutations) => {
        mutations.forEach(() => {
          applyCustomStyles();
        });
      });

      observer.observe(document.body, {
        childList: true,
        subtree: true,
        attributes: true,
        attributeFilter: ['style']
      });

      // Adicionar botão de fechar
      setTimeout(() => {
        const chatContainer = document.querySelector('div[style*="position: fixed"][style*="width"][style*="height"]:not([style*="56px"])');
        if (chatContainer && !chatContainer.querySelector('.custom-close-btn')) {
          const closeBtn = document.createElement('button');
          closeBtn.className = 'custom-close-btn';
          closeBtn.innerHTML = '×';
          closeBtn.style.cssText = `
            position: absolute !important;
            top: 12px !important;
            right: 15px !important;
            background: transparent !important;
            border: none !important;
            color: white !important;
            font-size: 28px !important;
            cursor: pointer !important;
            z-index: 10001 !important;
            line-height: 1 !important;
            padding: 0 !important;
            width: 30px !important;
            height: 30px !important;
          `;
          
          closeBtn.addEventListener('click', () => {
            chatContainer.style.display = 'none';
          });
          
          const header = chatContainer.querySelector('div:first-child');
          if (header) {
            header.appendChild(closeBtn);
          }
        }
      }, 2000);
    }
  </script>
</body>
</html>




